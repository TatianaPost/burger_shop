
// VARIABLES
// adjustment
const btn__close = document.querySelector('.btn__close'); // using in --pop up--, --  --
// section --do--
// --pop up--
const sidebar__mobile = document.querySelector('.nav-sidebar__mobile');
const transfer__menu = document.querySelector('.mobile__transfer__menu');
const menu__link = document.querySelectorAll('.transfer_item_link');

sidebar__mobile.addEventListener('click', (e) => {
  e.preventDefault();
  transfer__menu.style.top = '0px';
});
btn__close.addEventListener('click', (e) => {
  transfer__menu.style.top = '-9999px';
});
menu__link.forEach(link => {
  link.addEventListener('click', (e) => {
    e.preventDefault();
    transfer__menu.style.top = '-9999px';
  });
});

// burger --slider--
$(function () {

  var coloringDots = function(index) {
    $('.burger-slider')
      .find('.bottom__dots-item')
      .eq(index)
      .addClass('active_dot')
      .siblings()
      .removeClass('active_dot');
  };

  var generateDots = function () {
    $('.burger__carousel').each(function(){
      var dot = $('<li>', {
        attr : {
          class : 'bottom__dots-item'
        },
        html : '<div class="bottom__dots-item__circle"></div>'
      });
      $('.bottom__dots-list').append(dot);
    });
  };

  generateDots();

  var moveSlide = function (container, slideNum) {
    var 
      items = container.find('.burger__carousel'),
      activeSlide = items.filter('.burger_is-active')
      reqItem = items.eq(slideNum),
      reqIndex = reqItem.index(),
      list = container.find('.burger__carousel-list'),
      duration = 500;

    if (reqItem.length) {
      list.animate({
        'left': -reqIndex * 100 + '%'
      }, duration, function () {
        activeSlide.removeClass('burger_is-active');
        reqItem.addClass('burger_is-active');
        coloringDots(slideNum);
      });
    };
  };


  $('.slider__btn').on('click', function (e) {
    e.preventDefault();

        var $this = $(this),
            container = $this.closest('.burger-slider'),
            items = $('.burger__carousel', container),
            activeItem = items.filter('.burger_is-active'),
            existedItem, edgeItem, reqItem;

    if ($this.hasClass('slider_btn_next')) {// вперед
      existedItem = activeItem.next();
      edgeItem = items.first();
    }
    if ($this.hasClass('slider_btn_prev')) { //назад
      existedItem = activeItem.prev();
      edgeItem = items.last();  
    }
    reqItem = existedItem.length ? existedItem.index() : edgeItem.index();
    
    moveSlide(container, reqItem);

  });

  $('body').on('click', '.bottom__dots-item', function(){
    var $this = $(this),
      container = $this.closest('.burger-slider'),
      index = $this.index();
    moveSlide(container, index);
    coloringDots(index);
  });

});

// burger --ingridients--
const btnIngridients = document.querySelector('.block__float-ingridients');
const floatIngridients = document.querySelector('.float-ingridients__list');
const burger__container = document.querySelector('.burger-container');

btnIngridients.addEventListener('mousemove', (e) => {
  floatIngridients.style.opacity = '1';
  floatIngridients.style.left = '100%';
});
burger__container.addEventListener('mouseover', (e) => {
  floatIngridients.style.opacity = '0';
  floatIngridients.style.left = '-9999px';
});

// section --Team--
const team__item = document.querySelectorAll('.team__accordeon__item');
const items = document.querySelector('.team__accordeon__list');
const team__section = document.querySelector('.team');

items.addEventListener('click', (e) => {
  e.preventDefault();
  let target = e.target;

  if (target.className === 'team__accordeon__link') {
    let item = target.closest('.team__accordeon__item');
    if (item.classList.contains('team_accordeon_item_active')) {
      item.classList.toggle('team_accordeon_item_active');
    }
    else {
      team__item.forEach(function (item, index) {
        item.classList.remove('team_accordeon_item_active');
      })
      item.classList.add('team_accordeon_item_active');
    }
  }
})
// section --menu--

const menuList = document.querySelector('.menu__accordeon__list');
const menuItem = document.querySelectorAll('.menu__accordeon__item');

menuList.addEventListener('click', (e) => {
  e.preventDefault();
  let target = e.target;
  if (target.className === 'menu__accordeon__link__title') {
    let closestMenuItem = target.closest('.menu__accordeon__item');
    if (closestMenuItem.classList.contains('menu_accordeon_item_active')) {
      closestMenuItem.classList.toggle('menu_accordeon_item_active');
    }
    else {
      menuItem.forEach(function (closestMenuItem, index) {
        closestMenuItem.classList.remove('menu_accordeon_item_active');
      });
      closestMenuItem.classList.add('menu_accordeon_item_active');
    }
  }
});

// modal reviews 


function createOverlay(name, text) {

  const overlayElement = document.createElement('div');
  overlayElement.classList.add('reviews__overlay');

  const template = document.querySelector('#overlayReviews');
  overlayElement.innerHTML = template.innerHTML;

  const closeElement = overlayElement.querySelector('.reviews__overlay-close');
  closeElement.addEventListener('click', (e) => {
    e.preventDefault();
    document.body.removeChild(overlayElement);
  });
  const contentName = overlayElement.querySelector('.reviews__overlay-content__name');
  contentName.innerHTML = name;

  const contentText = overlayElement.querySelector('.reviews__overlay-content__discription');
  contentText.innerHTML = text;

  return overlayElement;
};

const openBtn = document.querySelectorAll('.review__btn__link');
const getName = document.querySelector('.review__name');
const getText = document.querySelector('.review__text');

var name = getName.innerHTML;
var text = getText.innerHTML;
const succesOverlay = createOverlay(name, text);

openBtn.forEach(evenBtn => {
  evenBtn.addEventListener('click', (e) => {
    // var target = e.target;
    // const getText = target.previousSibling('.review__text');
    var name = getName.innerHTML;
    var text = getText.innerHTML;
    document.body.appendChild(succesOverlay);
  });
});

// --Form--

const form = document.querySelector('#form');
const sendButton = document.querySelector('#sendButton');

sendButton.addEventListener('click', (e) => {
  e.preventDefault();
  var objFormNameText = [form.elements.name, form.elements.phone, form.elements.street,
  form.elements.house, form.elements.houseEntr, form.elements.entrance, form.elements.floor,
  form.elements.apartment];
  if (objFormNameText[0]) {
    console.log(form.elements.name.value);
  }
  if (objFormNameText[1]) {
    console.log(form.elements.phone.value);
  }
  if (objFormNameText[2]) {
    console.log(form.elements.street.value);
  }
  if (objFormNameText[3]) {
    console.log(form.elements.house.value);
  }
  if (objFormNameText[4]) {
    console.log(form.elements.houseEntr.value);
  }
  if (objFormNameText[5]) {
    console.log(form.elements.entrance.value);
  }
  if (objFormNameText[6]) {
    console.log(form.elements.floor.value);
  }
  if (objFormNameText[7]) {
    console.log(form.elements.apartment.value);
  }
});

// var array = [1,2,3,4,5,6,7,8,9,10];

// var squared = array.map(num => num * num);
// console.log(squared);
// --one page scroll--

// const sections = $('.section');
// const display = $('.maincontent');

// const performTransition = sectionEq() => {
//   const position = `$(-sectionEq * 100)%`;

//   display.css({
//     transform: `translateY(${position})`,
//     '-web-kit-transform': `translateY(${position})`
//   });
// }

const sections = $('.section');
const display = $('.maincontent');
let inScroll = false;

const setActiveMenuItem = itemEq => {
  $('.nav-sidebar__item')
  .eq(itemEq)
  .addClass('nav-sidebar_item_is-active')
  .siblings()
  .removeClass('nav-sidebar_item_is-active');
};

const performTransition = sectionEq => {
    const position = `${-sectionEq * 100}%`;

  if (inScroll) return;

  inScroll = true;

  sections
    .eq(sectionEq)
    .addClass('is-active')
    .siblings()
    .removeClass('is-active');
  display.css({
    transform: `translateY(${position})`,
    '-webkit-transform': `translateY(${position})`
  });
  const transitionDuration = parseInt(display.css('transition-duration')) * 1000; // time in ms
  setTimeout(() => {
    inScroll = false;
    setActiveMenuItem(sectionEq);
  }, transitionDuration + 300); // pf 300 мс проходит инерция мышки
};

const scrollToSection = direction => {
  const activeSection = sections.filter('.is-active');
  const nextSection = activeSection.next();
  const prevSection = activeSection.prev();

  if (direction === 'up' && prevSection.length) {
    performTransition(prevSection.index());
  }
  if (direction === 'down' && nextSection.length) {
    performTransition(nextSection.index());
  }
};


$(document).on({
  wheel : (e) => {
    const deltaY = e.originalEvent.deltaY;
    const direction = deltaY > 0
    ? 'down'
    : 'up'

      scrollToSection(direction);

  },
  keydown: e => {
    switch (e.keyCode) {
      case 40 :
        scrollToSection('down');
        break;
      case 38 :
        scrollToSection('up');
        break;
        
        break;
    
      default:
        break;
    }
  }
});

$('[data-scroll-to]').on('click', (e) => {
  e.preventDefault();
  
  const target = parseInt($(e.currentTarget).attr('data-scroll-to'));
  performTransition(target);
  
})





//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbi8vIFZBUklBQkxFU1xuLy8gYWRqdXN0bWVudFxuY29uc3QgYnRuX19jbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idG5fX2Nsb3NlJyk7IC8vIHVzaW5nIGluIC0tcG9wIHVwLS0sIC0tICAtLVxuLy8gc2VjdGlvbiAtLWRvLS1cbi8vIC0tcG9wIHVwLS1cbmNvbnN0IHNpZGViYXJfX21vYmlsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5uYXYtc2lkZWJhcl9fbW9iaWxlJyk7XG5jb25zdCB0cmFuc2Zlcl9fbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2JpbGVfX3RyYW5zZmVyX19tZW51Jyk7XG5jb25zdCBtZW51X19saW5rID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRyYW5zZmVyX2l0ZW1fbGluaycpO1xuXG5zaWRlYmFyX19tb2JpbGUuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHRyYW5zZmVyX19tZW51LnN0eWxlLnRvcCA9ICcwcHgnO1xufSk7XG5idG5fX2Nsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgdHJhbnNmZXJfX21lbnUuc3R5bGUudG9wID0gJy05OTk5cHgnO1xufSk7XG5tZW51X19saW5rLmZvckVhY2gobGluayA9PiB7XG4gIGxpbmsuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB0cmFuc2Zlcl9fbWVudS5zdHlsZS50b3AgPSAnLTk5OTlweCc7XG4gIH0pO1xufSk7XG5cbi8vIGJ1cmdlciAtLXNsaWRlci0tXG4kKGZ1bmN0aW9uICgpIHtcblxuICB2YXIgY29sb3JpbmdEb3RzID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICAkKCcuYnVyZ2VyLXNsaWRlcicpXG4gICAgICAuZmluZCgnLmJvdHRvbV9fZG90cy1pdGVtJylcbiAgICAgIC5lcShpbmRleClcbiAgICAgIC5hZGRDbGFzcygnYWN0aXZlX2RvdCcpXG4gICAgICAuc2libGluZ3MoKVxuICAgICAgLnJlbW92ZUNsYXNzKCdhY3RpdmVfZG90Jyk7XG4gIH07XG5cbiAgdmFyIGdlbmVyYXRlRG90cyA9IGZ1bmN0aW9uICgpIHtcbiAgICAkKCcuYnVyZ2VyX19jYXJvdXNlbCcpLmVhY2goZnVuY3Rpb24oKXtcbiAgICAgIHZhciBkb3QgPSAkKCc8bGk+Jywge1xuICAgICAgICBhdHRyIDoge1xuICAgICAgICAgIGNsYXNzIDogJ2JvdHRvbV9fZG90cy1pdGVtJ1xuICAgICAgICB9LFxuICAgICAgICBodG1sIDogJzxkaXYgY2xhc3M9XCJib3R0b21fX2RvdHMtaXRlbV9fY2lyY2xlXCI+PC9kaXY+J1xuICAgICAgfSk7XG4gICAgICAkKCcuYm90dG9tX19kb3RzLWxpc3QnKS5hcHBlbmQoZG90KTtcbiAgICB9KTtcbiAgfTtcblxuICBnZW5lcmF0ZURvdHMoKTtcblxuICB2YXIgbW92ZVNsaWRlID0gZnVuY3Rpb24gKGNvbnRhaW5lciwgc2xpZGVOdW0pIHtcbiAgICB2YXIgXG4gICAgICBpdGVtcyA9IGNvbnRhaW5lci5maW5kKCcuYnVyZ2VyX19jYXJvdXNlbCcpLFxuICAgICAgYWN0aXZlU2xpZGUgPSBpdGVtcy5maWx0ZXIoJy5idXJnZXJfaXMtYWN0aXZlJylcbiAgICAgIHJlcUl0ZW0gPSBpdGVtcy5lcShzbGlkZU51bSksXG4gICAgICByZXFJbmRleCA9IHJlcUl0ZW0uaW5kZXgoKSxcbiAgICAgIGxpc3QgPSBjb250YWluZXIuZmluZCgnLmJ1cmdlcl9fY2Fyb3VzZWwtbGlzdCcpLFxuICAgICAgZHVyYXRpb24gPSA1MDA7XG5cbiAgICBpZiAocmVxSXRlbS5sZW5ndGgpIHtcbiAgICAgIGxpc3QuYW5pbWF0ZSh7XG4gICAgICAgICdsZWZ0JzogLXJlcUluZGV4ICogMTAwICsgJyUnXG4gICAgICB9LCBkdXJhdGlvbiwgZnVuY3Rpb24gKCkge1xuICAgICAgICBhY3RpdmVTbGlkZS5yZW1vdmVDbGFzcygnYnVyZ2VyX2lzLWFjdGl2ZScpO1xuICAgICAgICByZXFJdGVtLmFkZENsYXNzKCdidXJnZXJfaXMtYWN0aXZlJyk7XG4gICAgICAgIGNvbG9yaW5nRG90cyhzbGlkZU51bSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9O1xuXG5cbiAgJCgnLnNsaWRlcl9fYnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgICAgICAgIGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoJy5idXJnZXItc2xpZGVyJyksXG4gICAgICAgICAgICBpdGVtcyA9ICQoJy5idXJnZXJfX2Nhcm91c2VsJywgY29udGFpbmVyKSxcbiAgICAgICAgICAgIGFjdGl2ZUl0ZW0gPSBpdGVtcy5maWx0ZXIoJy5idXJnZXJfaXMtYWN0aXZlJyksXG4gICAgICAgICAgICBleGlzdGVkSXRlbSwgZWRnZUl0ZW0sIHJlcUl0ZW07XG5cbiAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ3NsaWRlcl9idG5fbmV4dCcpKSB7Ly8g0LLQv9C10YDQtdC0XG4gICAgICBleGlzdGVkSXRlbSA9IGFjdGl2ZUl0ZW0ubmV4dCgpO1xuICAgICAgZWRnZUl0ZW0gPSBpdGVtcy5maXJzdCgpO1xuICAgIH1cbiAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ3NsaWRlcl9idG5fcHJldicpKSB7IC8v0L3QsNC30LDQtFxuICAgICAgZXhpc3RlZEl0ZW0gPSBhY3RpdmVJdGVtLnByZXYoKTtcbiAgICAgIGVkZ2VJdGVtID0gaXRlbXMubGFzdCgpOyAgXG4gICAgfVxuICAgIHJlcUl0ZW0gPSBleGlzdGVkSXRlbS5sZW5ndGggPyBleGlzdGVkSXRlbS5pbmRleCgpIDogZWRnZUl0ZW0uaW5kZXgoKTtcbiAgICBcbiAgICBtb3ZlU2xpZGUoY29udGFpbmVyLCByZXFJdGVtKTtcblxuICB9KTtcblxuICAkKCdib2R5Jykub24oJ2NsaWNrJywgJy5ib3R0b21fX2RvdHMtaXRlbScsIGZ1bmN0aW9uKCl7XG4gICAgdmFyICR0aGlzID0gJCh0aGlzKSxcbiAgICAgIGNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoJy5idXJnZXItc2xpZGVyJyksXG4gICAgICBpbmRleCA9ICR0aGlzLmluZGV4KCk7XG4gICAgbW92ZVNsaWRlKGNvbnRhaW5lciwgaW5kZXgpO1xuICAgIGNvbG9yaW5nRG90cyhpbmRleCk7XG4gIH0pO1xuXG59KTtcblxuLy8gYnVyZ2VyIC0taW5ncmlkaWVudHMtLVxuY29uc3QgYnRuSW5ncmlkaWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYmxvY2tfX2Zsb2F0LWluZ3JpZGllbnRzJyk7XG5jb25zdCBmbG9hdEluZ3JpZGllbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZsb2F0LWluZ3JpZGllbnRzX19saXN0Jyk7XG5jb25zdCBidXJnZXJfX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5idXJnZXItY29udGFpbmVyJyk7XG5cbmJ0bkluZ3JpZGllbnRzLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChlKSA9PiB7XG4gIGZsb2F0SW5ncmlkaWVudHMuc3R5bGUub3BhY2l0eSA9ICcxJztcbiAgZmxvYXRJbmdyaWRpZW50cy5zdHlsZS5sZWZ0ID0gJzEwMCUnO1xufSk7XG5idXJnZXJfX2NvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4ge1xuICBmbG9hdEluZ3JpZGllbnRzLnN0eWxlLm9wYWNpdHkgPSAnMCc7XG4gIGZsb2F0SW5ncmlkaWVudHMuc3R5bGUubGVmdCA9ICctOTk5OXB4Jztcbn0pO1xuXG4vLyBzZWN0aW9uIC0tVGVhbS0tXG5jb25zdCB0ZWFtX19pdGVtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnRlYW1fX2FjY29yZGVvbl9faXRlbScpO1xuY29uc3QgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudGVhbV9fYWNjb3JkZW9uX19saXN0Jyk7XG5jb25zdCB0ZWFtX19zZWN0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnRlYW0nKTtcblxuaXRlbXMuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcblxuICBpZiAodGFyZ2V0LmNsYXNzTmFtZSA9PT0gJ3RlYW1fX2FjY29yZGVvbl9fbGluaycpIHtcbiAgICBsZXQgaXRlbSA9IHRhcmdldC5jbG9zZXN0KCcudGVhbV9fYWNjb3JkZW9uX19pdGVtJyk7XG4gICAgaWYgKGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCd0ZWFtX2FjY29yZGVvbl9pdGVtX2FjdGl2ZScpKSB7XG4gICAgICBpdGVtLmNsYXNzTGlzdC50b2dnbGUoJ3RlYW1fYWNjb3JkZW9uX2l0ZW1fYWN0aXZlJyk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdGVhbV9faXRlbS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpbmRleCkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ3RlYW1fYWNjb3JkZW9uX2l0ZW1fYWN0aXZlJyk7XG4gICAgICB9KVxuICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCd0ZWFtX2FjY29yZGVvbl9pdGVtX2FjdGl2ZScpO1xuICAgIH1cbiAgfVxufSlcbi8vIHNlY3Rpb24gLS1tZW51LS1cblxuY29uc3QgbWVudUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWVudV9fYWNjb3JkZW9uX19saXN0Jyk7XG5jb25zdCBtZW51SXRlbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tZW51X19hY2NvcmRlb25fX2l0ZW0nKTtcblxubWVudUxpc3QuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGxldCB0YXJnZXQgPSBlLnRhcmdldDtcbiAgaWYgKHRhcmdldC5jbGFzc05hbWUgPT09ICdtZW51X19hY2NvcmRlb25fX2xpbmtfX3RpdGxlJykge1xuICAgIGxldCBjbG9zZXN0TWVudUl0ZW0gPSB0YXJnZXQuY2xvc2VzdCgnLm1lbnVfX2FjY29yZGVvbl9faXRlbScpO1xuICAgIGlmIChjbG9zZXN0TWVudUl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdtZW51X2FjY29yZGVvbl9pdGVtX2FjdGl2ZScpKSB7XG4gICAgICBjbG9zZXN0TWVudUl0ZW0uY2xhc3NMaXN0LnRvZ2dsZSgnbWVudV9hY2NvcmRlb25faXRlbV9hY3RpdmUnKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICBtZW51SXRlbS5mb3JFYWNoKGZ1bmN0aW9uIChjbG9zZXN0TWVudUl0ZW0sIGluZGV4KSB7XG4gICAgICAgIGNsb3Nlc3RNZW51SXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdtZW51X2FjY29yZGVvbl9pdGVtX2FjdGl2ZScpO1xuICAgICAgfSk7XG4gICAgICBjbG9zZXN0TWVudUl0ZW0uY2xhc3NMaXN0LmFkZCgnbWVudV9hY2NvcmRlb25faXRlbV9hY3RpdmUnKTtcbiAgICB9XG4gIH1cbn0pO1xuXG4vLyBtb2RhbCByZXZpZXdzIFxuXG5cbmZ1bmN0aW9uIGNyZWF0ZU92ZXJsYXkobmFtZSwgdGV4dCkge1xuXG4gIGNvbnN0IG92ZXJsYXlFbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIG92ZXJsYXlFbGVtZW50LmNsYXNzTGlzdC5hZGQoJ3Jldmlld3NfX292ZXJsYXknKTtcblxuICBjb25zdCB0ZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNvdmVybGF5UmV2aWV3cycpO1xuICBvdmVybGF5RWxlbWVudC5pbm5lckhUTUwgPSB0ZW1wbGF0ZS5pbm5lckhUTUw7XG5cbiAgY29uc3QgY2xvc2VFbGVtZW50ID0gb3ZlcmxheUVsZW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlld3NfX292ZXJsYXktY2xvc2UnKTtcbiAgY2xvc2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGUpID0+IHtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChvdmVybGF5RWxlbWVudCk7XG4gIH0pO1xuICBjb25zdCBjb250ZW50TmFtZSA9IG92ZXJsYXlFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzX19vdmVybGF5LWNvbnRlbnRfX25hbWUnKTtcbiAgY29udGVudE5hbWUuaW5uZXJIVE1MID0gbmFtZTtcblxuICBjb25zdCBjb250ZW50VGV4dCA9IG92ZXJsYXlFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzX19vdmVybGF5LWNvbnRlbnRfX2Rpc2NyaXB0aW9uJyk7XG4gIGNvbnRlbnRUZXh0LmlubmVySFRNTCA9IHRleHQ7XG5cbiAgcmV0dXJuIG92ZXJsYXlFbGVtZW50O1xufTtcblxuY29uc3Qgb3BlbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5yZXZpZXdfX2J0bl9fbGluaycpO1xuY29uc3QgZ2V0TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdfX25hbWUnKTtcbmNvbnN0IGdldFRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmV2aWV3X190ZXh0Jyk7XG5cbnZhciBuYW1lID0gZ2V0TmFtZS5pbm5lckhUTUw7XG52YXIgdGV4dCA9IGdldFRleHQuaW5uZXJIVE1MO1xuY29uc3Qgc3VjY2VzT3ZlcmxheSA9IGNyZWF0ZU92ZXJsYXkobmFtZSwgdGV4dCk7XG5cbm9wZW5CdG4uZm9yRWFjaChldmVuQnRuID0+IHtcbiAgZXZlbkJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIChlKSA9PiB7XG4gICAgLy8gdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuICAgIC8vIGNvbnN0IGdldFRleHQgPSB0YXJnZXQucHJldmlvdXNTaWJsaW5nKCcucmV2aWV3X190ZXh0Jyk7XG4gICAgdmFyIG5hbWUgPSBnZXROYW1lLmlubmVySFRNTDtcbiAgICB2YXIgdGV4dCA9IGdldFRleHQuaW5uZXJIVE1MO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc3VjY2VzT3ZlcmxheSk7XG4gIH0pO1xufSk7XG5cbi8vIC0tRm9ybS0tXG5cbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjZm9ybScpO1xuY29uc3Qgc2VuZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNzZW5kQnV0dG9uJyk7XG5cbnNlbmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHZhciBvYmpGb3JtTmFtZVRleHQgPSBbZm9ybS5lbGVtZW50cy5uYW1lLCBmb3JtLmVsZW1lbnRzLnBob25lLCBmb3JtLmVsZW1lbnRzLnN0cmVldCxcbiAgZm9ybS5lbGVtZW50cy5ob3VzZSwgZm9ybS5lbGVtZW50cy5ob3VzZUVudHIsIGZvcm0uZWxlbWVudHMuZW50cmFuY2UsIGZvcm0uZWxlbWVudHMuZmxvb3IsXG4gIGZvcm0uZWxlbWVudHMuYXBhcnRtZW50XTtcbiAgaWYgKG9iakZvcm1OYW1lVGV4dFswXSkge1xuICAgIGNvbnNvbGUubG9nKGZvcm0uZWxlbWVudHMubmFtZS52YWx1ZSk7XG4gIH1cbiAgaWYgKG9iakZvcm1OYW1lVGV4dFsxXSkge1xuICAgIGNvbnNvbGUubG9nKGZvcm0uZWxlbWVudHMucGhvbmUudmFsdWUpO1xuICB9XG4gIGlmIChvYmpGb3JtTmFtZVRleHRbMl0pIHtcbiAgICBjb25zb2xlLmxvZyhmb3JtLmVsZW1lbnRzLnN0cmVldC52YWx1ZSk7XG4gIH1cbiAgaWYgKG9iakZvcm1OYW1lVGV4dFszXSkge1xuICAgIGNvbnNvbGUubG9nKGZvcm0uZWxlbWVudHMuaG91c2UudmFsdWUpO1xuICB9XG4gIGlmIChvYmpGb3JtTmFtZVRleHRbNF0pIHtcbiAgICBjb25zb2xlLmxvZyhmb3JtLmVsZW1lbnRzLmhvdXNlRW50ci52YWx1ZSk7XG4gIH1cbiAgaWYgKG9iakZvcm1OYW1lVGV4dFs1XSkge1xuICAgIGNvbnNvbGUubG9nKGZvcm0uZWxlbWVudHMuZW50cmFuY2UudmFsdWUpO1xuICB9XG4gIGlmIChvYmpGb3JtTmFtZVRleHRbNl0pIHtcbiAgICBjb25zb2xlLmxvZyhmb3JtLmVsZW1lbnRzLmZsb29yLnZhbHVlKTtcbiAgfVxuICBpZiAob2JqRm9ybU5hbWVUZXh0WzddKSB7XG4gICAgY29uc29sZS5sb2coZm9ybS5lbGVtZW50cy5hcGFydG1lbnQudmFsdWUpO1xuICB9XG59KTtcblxuLy8gdmFyIGFycmF5ID0gWzEsMiwzLDQsNSw2LDcsOCw5LDEwXTtcblxuLy8gdmFyIHNxdWFyZWQgPSBhcnJheS5tYXAobnVtID0+IG51bSAqIG51bSk7XG4vLyBjb25zb2xlLmxvZyhzcXVhcmVkKTtcbi8vIC0tb25lIHBhZ2Ugc2Nyb2xsLS1cblxuLy8gY29uc3Qgc2VjdGlvbnMgPSAkKCcuc2VjdGlvbicpO1xuLy8gY29uc3QgZGlzcGxheSA9ICQoJy5tYWluY29udGVudCcpO1xuXG4vLyBjb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IHNlY3Rpb25FcSgpID0+IHtcbi8vICAgY29uc3QgcG9zaXRpb24gPSBgJCgtc2VjdGlvbkVxICogMTAwKSVgO1xuXG4vLyAgIGRpc3BsYXkuY3NzKHtcbi8vICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259KWAsXG4vLyAgICAgJy13ZWIta2l0LXRyYW5zZm9ybSc6IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259KWBcbi8vICAgfSk7XG4vLyB9XG5cbmNvbnN0IHNlY3Rpb25zID0gJCgnLnNlY3Rpb24nKTtcbmNvbnN0IGRpc3BsYXkgPSAkKCcubWFpbmNvbnRlbnQnKTtcbmxldCBpblNjcm9sbCA9IGZhbHNlO1xuXG5jb25zdCBzZXRBY3RpdmVNZW51SXRlbSA9IGl0ZW1FcSA9PiB7XG4gICQoJy5uYXYtc2lkZWJhcl9faXRlbScpXG4gIC5lcShpdGVtRXEpXG4gIC5hZGRDbGFzcygnbmF2LXNpZGViYXJfaXRlbV9pcy1hY3RpdmUnKVxuICAuc2libGluZ3MoKVxuICAucmVtb3ZlQ2xhc3MoJ25hdi1zaWRlYmFyX2l0ZW1faXMtYWN0aXZlJyk7XG59O1xuXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IHNlY3Rpb25FcSA9PiB7XG4gICAgY29uc3QgcG9zaXRpb24gPSBgJHstc2VjdGlvbkVxICogMTAwfSVgO1xuXG4gIGlmIChpblNjcm9sbCkgcmV0dXJuO1xuXG4gIGluU2Nyb2xsID0gdHJ1ZTtcblxuICBzZWN0aW9uc1xuICAgIC5lcShzZWN0aW9uRXEpXG4gICAgLmFkZENsYXNzKCdpcy1hY3RpdmUnKVxuICAgIC5zaWJsaW5ncygpXG4gICAgLnJlbW92ZUNsYXNzKCdpcy1hY3RpdmUnKTtcbiAgZGlzcGxheS5jc3Moe1xuICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoJHtwb3NpdGlvbn0pYCxcbiAgICAnLXdlYmtpdC10cmFuc2Zvcm0nOiBgdHJhbnNsYXRlWSgke3Bvc2l0aW9ufSlgXG4gIH0pO1xuICBjb25zdCB0cmFuc2l0aW9uRHVyYXRpb24gPSBwYXJzZUludChkaXNwbGF5LmNzcygndHJhbnNpdGlvbi1kdXJhdGlvbicpKSAqIDEwMDA7IC8vIHRpbWUgaW4gbXNcbiAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgaW5TY3JvbGwgPSBmYWxzZTtcbiAgICBzZXRBY3RpdmVNZW51SXRlbShzZWN0aW9uRXEpO1xuICB9LCB0cmFuc2l0aW9uRHVyYXRpb24gKyAzMDApOyAvLyBwZiAzMDAg0LzRgSDQv9GA0L7RhdC+0LTQuNGCINC40L3QtdGA0YbQuNGPINC80YvRiNC60Lhcbn07XG5cbmNvbnN0IHNjcm9sbFRvU2VjdGlvbiA9IGRpcmVjdGlvbiA9PiB7XG4gIGNvbnN0IGFjdGl2ZVNlY3Rpb24gPSBzZWN0aW9ucy5maWx0ZXIoJy5pcy1hY3RpdmUnKTtcbiAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcbiAgY29uc3QgcHJldlNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLnByZXYoKTtcblxuICBpZiAoZGlyZWN0aW9uID09PSAndXAnICYmIHByZXZTZWN0aW9uLmxlbmd0aCkge1xuICAgIHBlcmZvcm1UcmFuc2l0aW9uKHByZXZTZWN0aW9uLmluZGV4KCkpO1xuICB9XG4gIGlmIChkaXJlY3Rpb24gPT09ICdkb3duJyAmJiBuZXh0U2VjdGlvbi5sZW5ndGgpIHtcbiAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcbiAgfVxufTtcblxuXG4kKGRvY3VtZW50KS5vbih7XG4gIHdoZWVsIDogKGUpID0+IHtcbiAgICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xuICAgIGNvbnN0IGRpcmVjdGlvbiA9IGRlbHRhWSA+IDBcbiAgICA/ICdkb3duJ1xuICAgIDogJ3VwJ1xuXG4gICAgICBzY3JvbGxUb1NlY3Rpb24oZGlyZWN0aW9uKTtcblxuICB9LFxuICBrZXlkb3duOiBlID0+IHtcbiAgICBzd2l0Y2ggKGUua2V5Q29kZSkge1xuICAgICAgY2FzZSA0MCA6XG4gICAgICAgIHNjcm9sbFRvU2VjdGlvbignZG93bicpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgMzggOlxuICAgICAgICBzY3JvbGxUb1NlY3Rpb24oJ3VwJyk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgICBcbiAgICAgICAgYnJlYWs7XG4gICAgXG4gICAgICBkZWZhdWx0OlxuICAgICAgICBicmVhaztcbiAgICB9XG4gIH1cbn0pO1xuXG4kKCdbZGF0YS1zY3JvbGwtdG9dJykub24oJ2NsaWNrJywgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBcbiAgY29uc3QgdGFyZ2V0ID0gcGFyc2VJbnQoJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ2RhdGEtc2Nyb2xsLXRvJykpO1xuICBwZXJmb3JtVHJhbnNpdGlvbih0YXJnZXQpO1xuICBcbn0pXG5cblxuXG5cbiJdfQ==
